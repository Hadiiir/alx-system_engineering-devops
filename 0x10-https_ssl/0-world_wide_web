#!/usr/bin/env bash
# Script to audit domain subdomains and display DNS information

# Function to get subdomain information
get_subdomain_info() {
    local domain="$1"
    local subdomain="$2"
    
    # Use dig to get DNS information and parse with awk
    local result=$(dig "${subdomain}.${domain}" | awk '/ANSWER SECTION:/{getline; print}')
    
    if [[ -n "$result" ]]; then
        local record_type=$(echo "$result" | awk '{print $4}')
        local destination=$(echo "$result" | awk '{print $5}')
        echo "The subdomain $subdomain is a $record_type record and points to $destination"
    fi
}

# Main function
main() {
    local domain="$1"
    local subdomain="$2"
    
    # If subdomain is specified, show only that subdomain
    if [[ -n "$subdomain" ]]; then
        get_subdomain_info "$domain" "$subdomain"
    else
        # Show default subdomains in specified order
        local subdomains=("www" "lb-01" "web-01" "web-02")
        for sub in "${subdomains[@]}"; do
            get_subdomain_info "$domain" "$sub"
        done
    fi
}

# Call main function with all arguments
main "$@"
