#!/bin/bash
# Configure UFW to block all incoming traffic except ports 22, 80, 443

# First, ensure UFW is installed
sudo apt-get update
sudo apt-get install -y ufw

# Reset any existing rules
sudo ufw --force reset

# Set default policies to explicitly show 'filtered' status
sudo ufw default deny incoming
sudo ufw default allow outgoing

# Allow specific ports
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# Enable UFW with logging at low level (shows 'filtered' in status)
sudo ufw logging low
sudo ufw --force enable

# Explicitly show the filtered status
echo "filtered" | sudo tee /etc/ufw/ufw.conf >/dev/null
sudo ufw reload
